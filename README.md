# è±†è…èŠ±è¯­éŸ³èŠå¤© - Discord Clone

ä¸€ä¸ªç±»ä¼¼ Discord çš„ WebRTC è¯­éŸ³èŠå¤©åº”ç”¨ï¼Œæ”¯æŒé‚®ç®±æ³¨å†Œã€é¢‘é“ç®¡ç†ã€è¯­éŸ³é€šè¯å’Œå®æ—¶èŠå¤©ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” ç”¨æˆ·é‚®ç®±æ³¨å†Œå’Œç™»å½•ç³»ç»Ÿ
- ğŸ“ åˆ›å»ºå’ŒåŠ å…¥è¯­éŸ³é¢‘é“
- ğŸ™ï¸ WebRTC å®æ—¶è¯­éŸ³é€šä¿¡
- ğŸ’¬ å®æ—¶æ–‡å­—èŠå¤©
- ğŸ‘¥ ç”¨æˆ·åœ¨çº¿çŠ¶æ€æ˜¾ç¤º
- ğŸ¨ ç°ä»£åŒ– UI è®¾è®¡ (Ant Design)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React + TypeScript** - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **Vite** - å¿«é€Ÿæ„å»ºå·¥å…·
- **Ant Design** - ä¼ä¸šçº§ UI è®¾è®¡è¯­è¨€
- **Socket.IO Client** - WebSocket å®¢æˆ·ç«¯
- **WebRTC API** - å®æ—¶éŸ³è§†é¢‘é€šä¿¡

### åç«¯
- **Node.js + Express** - æœåŠ¡ç«¯æ¡†æ¶
- **SQLite** - è½»é‡çº§æ•°æ®åº“
- **Socket.IO** - WebSocket æœåŠ¡ç«¯
- **JWT** - èº«ä»½è®¤è¯
- **bcryptjs** - å¯†ç åŠ å¯†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js >= 16.0.0
- npm >= 7.0.0

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone [your-repo-url]
cd tofu-douhua

# å®‰è£…å‰ç«¯ä¾èµ–
cd client
npm install

# å®‰è£…åç«¯ä¾èµ–
cd ../server
npm install
```

### è¿è¡Œé¡¹ç›®

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)
```bash
chmod +x start.sh
./start.sh
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
```bash
# å¯åŠ¨åç«¯æœåŠ¡ (ç«¯å£ 3001)
cd server
npm run dev

# æ–°ç»ˆç«¯çª—å£ï¼Œå¯åŠ¨å‰ç«¯æœåŠ¡ (ç«¯å£ 5173)
cd client
npm run dev
```

### ğŸŒ è®¿é—®åº”ç”¨
- å‰ç«¯åº”ç”¨: http://localhost:5173
- åç«¯ API: http://localhost:3001

## ğŸ“ é¡¹ç›®ç»“æ„

```
tofu-douhua/
â”œâ”€â”€ client/                    # React å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Auth.tsx       # ç™»å½•/æ³¨å†Œç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MainApp.tsx    # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ChannelList.tsx # é¢‘é“åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ ChatArea.tsx   # èŠå¤©åŒºåŸŸ
â”‚   â”‚   â”œâ”€â”€ services/          # API æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts         # HTTP API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ socket.ts      # WebSocket å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ hooks/             # React Hooks
â”‚   â”‚   â”‚   â””â”€â”€ useWebRTC.ts   # WebRTC Hook
â”‚   â”‚   â”œâ”€â”€ types/             # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ App.tsx            # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ server/                    # Node.js åç«¯
â”‚   â”œâ”€â”€ index.js               # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”‚   â”œâ”€â”€ discord.db             # SQLite æ•°æ®åº“æ–‡ä»¶ (è‡ªåŠ¨ç”Ÿæˆ)
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ start.sh                   # ä¸€é”®å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md
```

## ğŸ¯ ä½¿ç”¨è¯´æ˜

### 1. æ³¨å†Œ/ç™»å½•
- é¦–æ¬¡ä½¿ç”¨éœ€è¦æ³¨å†Œè´¦å·ï¼ˆé‚®ç®± + å¯†ç  + ç”¨æˆ·åï¼‰
- å·²æœ‰è´¦å·å¯ç›´æ¥ç™»å½•

### 2. åˆ›å»ºé¢‘é“
- ç‚¹å‡»é¢‘é“åˆ—è¡¨å³ä¸Šè§’çš„ "+" æŒ‰é’®
- è¾“å…¥é¢‘é“åç§°å’Œæè¿°
- åˆ›å»ºåè‡ªåŠ¨åŠ å…¥é¢‘é“

### 3. åŠ å…¥é¢‘é“
- ç‚¹å‡»ä»»æ„é¢‘é“å³å¯åŠ å…¥
- åŠ å…¥åå¯ä»¥çœ‹åˆ°é¢‘é“å†…çš„èŠå¤©è®°å½•

### 4. è¯­éŸ³é€šè¯
- åœ¨é¢‘é“å†…ç‚¹å‡» "åŠ å…¥è¯­éŸ³" æŒ‰é’®
- æˆæƒéº¦å…‹é£æƒé™
- ä¸é¢‘é“å†…å…¶ä»–ç”¨æˆ·è¿›è¡Œè¯­éŸ³é€šè¯

### 5. æ–‡å­—èŠå¤©
- åœ¨èŠå¤©æ¡†è¾“å…¥æ¶ˆæ¯å¹¶å‘é€
- æ‰€æœ‰é¢‘é“æˆå‘˜éƒ½èƒ½çœ‹åˆ°æ¶ˆæ¯

## ğŸ”§ å¼€å‘è¯´æ˜

### æ•°æ®åº“ç»“æ„
åº”ç”¨ä½¿ç”¨ SQLite æ•°æ®åº“ï¼ŒåŒ…å«ä»¥ä¸‹è¡¨ï¼š
- `users` - ç”¨æˆ·ä¿¡æ¯
- `channels` - é¢‘é“ä¿¡æ¯  
- `channel_members` - é¢‘é“æˆå‘˜å…³ç³»
- `messages` - èŠå¤©æ¶ˆæ¯

### API æ¥å£
- `POST /api/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/login` - ç”¨æˆ·ç™»å½•
- `GET /api/channels` - è·å–é¢‘é“åˆ—è¡¨
- `POST /api/channels` - åˆ›å»ºé¢‘é“
- `POST /api/channels/:id/join` - åŠ å…¥é¢‘é“
- `GET /api/channels/:id/messages` - è·å–é¢‘é“æ¶ˆæ¯

### WebSocket äº‹ä»¶
- `user-joined` - ç”¨æˆ·ä¸Šçº¿
- `join-channel` - åŠ å…¥é¢‘é“
- `leave-channel` - ç¦»å¼€é¢‘é“
- `send-message` - å‘é€æ¶ˆæ¯
- `webrtc-signal` - WebRTC ä¿¡ä»¤

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£å†²çª**
   ```bash
   # åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
   pkill -f "node index.js"
   pkill -f "vite"
   ```

2. **æ•°æ®åº“æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿ server ç›®å½•æœ‰å†™æƒé™
   chmod 755 server/
   ```

3. **éº¦å…‹é£æƒé™**
   - ç¡®ä¿æµè§ˆå™¨å…è®¸è®¿é—®éº¦å…‹é£
   - ä½¿ç”¨ HTTPS æˆ– localhost è®¿é—®

4. **WebRTC è¿æ¥é—®é¢˜**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - ç¡®ä¿ç½‘ç»œæ”¯æŒ P2P è¿æ¥

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License